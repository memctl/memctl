---
title: AGENTS.md
description: Copy-paste AGENTS.md template for mem/ctl MCP usage
---

# AGENTS.md

Copy this into your repository root as `AGENTS.md`. This works with any MCP-compatible agent (Claude Code, Cursor, VS Code, Windsurf, Cline, etc.).

Some agents read a different filename. Use `generate --link` to create symlinks automatically, or create them manually:

```bash
# Automatic: generate AGENTS.md and symlink CLAUDE.md + GEMINI.md to it
npx memctl generate --claude --gemini --link

# Manual
ln -s AGENTS.md CLAUDE.md
ln -s AGENTS.md GEMINI.md
```

```md
# AGENTS.md

## memctl MCP Rules

MCP server name is `memctl`.
Use `memctl` for all project memory: session history, coding conventions, architecture decisions, testing rules, branch plans.
Store decisions and lessons learned in memctl so they persist across sessions.

## Session Start

1. `context` with `{"action":"bootstrap"}` - load all project context
2. `session` with `{"action":"start","sessionId":"<unique-id>","autoExtractGit":true}` - register this session
3. `activity` with `{"action":"memo_read"}` - check handoff notes from previous sessions
4. `branch` with `{"action":"get","includeRelatedContext":true}` - load branch plan and related context

If the file map is stale, run `repo` with `{"action":"scan_check"}`, then run `repo` with `{"action":"scan","saveAsContext":true}`.

## Before Coding

- `context` with `{"action":"functionality_get","type":"coding_style"}`, and repeat for: `architecture`, `testing`, `constraints`, `workflow`
- `context` with `{"action":"context_for","filePaths":[...]}` for files you are about to touch
- `branch` with `{"action":"get","includeRelatedContext":true}` for current plan and checklist

## While Coding

- `context` with `{"action":"functionality_set","type":"...","id":"...","title":"...","content":"..."}` for structured rules
- `memory` with `{"action":"search","query":"..."}` before `{"action":"store","key":"...","content":"..."}` for one-off decisions
- `branch` with `{"action":"set","content":"...","status":"in_progress"}` after each meaningful task

## End Of Session

1. `branch` with `{"action":"set","content":"...","status":"review"}` with final progress
2. `activity` with `{"action":"memo_leave","message":"...","urgency":"info"}` if anything is pending
3. `session` with `{"action":"end","sessionId":"<same-id>","summary":"..."}`

## Maintenance

Run every few sessions:

- `memory_lifecycle` with `{"action":"suggest_cleanup","staleDays":30}` - review stale candidates
- `memory_lifecycle` with `{"action":"lifecycle_run","policies":["cleanup_expired","cleanup_session_logs","archive_merged_branches"]}` - run periodic cleanup
- `memory_advanced` with `{"action":"check_duplicates","content":"..."}` - find duplicate candidates

## Rules

- Do not store secrets, tokens, or API keys
- Do not store large file contents or binary data
- Do not store generic agent capabilities (file scanning, pattern search, grep usage)
- Do not skip `context` with `{"action":"bootstrap"}` at session start
- Search before storing to avoid duplicates
- Do not let memory grow unchecked
```

## Importing and exporting

Generate agent config files from your stored context:

```bash
# Write AGENTS.md to the current directory
npx memctl generate

# Pick specific agents
npx memctl generate --claude           # + CLAUDE.md
npx memctl generate --gemini           # + GEMINI.md
npx memctl generate --cursor           # + .cursorrules
npx memctl generate --copilot          # + .github/copilot-instructions.md
npx memctl generate --all              # all of the above

# Symlink instead of copying (avoids content drift)
npx memctl generate --all --link

# Import an existing AGENTS.md into memctl
npx memctl import AGENTS.md
```

With `--link`, files that share the same format as `AGENTS.md` (CLAUDE.md, GEMINI.md, copilot-instructions.md) become symlinks. `.cursorrules` is always a real file because it uses a different format. See [generate docs](/docs/cli/import-export#generate) for details.

For pipe-friendly output, use `export` instead:

```bash
npx memctl export agents_md > custom-path/AGENTS.md
npx memctl export cursorrules > .cursorrules
```

Or via MCP tools:

```
import_export.export_agents_md   - generate AGENTS.md from stored context
import_export.agents_md_import   - parse and import AGENTS.md content (supports dryRun)
import_export.cursorrules_import - parse and import .cursorrules content
```

Need full tool details? See [MCP Tools](/docs/mcp-server/tools).
